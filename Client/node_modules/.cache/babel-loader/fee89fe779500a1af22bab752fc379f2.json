{"ast":null,"code":"import _classCallCheck from\"/Users/anirudhrv/Desktop/Misc/InteractiveImageAnnotation/Application/ImageAnnotation/Client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/anirudhrv/Desktop/Misc/InteractiveImageAnnotation/Application/ImageAnnotation/Client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/anirudhrv/Desktop/Misc/InteractiveImageAnnotation/Application/ImageAnnotation/Client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/anirudhrv/Desktop/Misc/InteractiveImageAnnotation/Application/ImageAnnotation/Client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/anirudhrv/Desktop/Misc/InteractiveImageAnnotation/Application/ImageAnnotation/Client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import'./App.css';import axios from'axios';var WorkingArea=/*#__PURE__*/function(_Component){_inherits(WorkingArea,_Component);//TODO : ADD INTRODUCTION TO PROJECT\nfunction WorkingArea(){var _this;_classCallCheck(this,WorkingArea);_this=_possibleConstructorReturn(this,_getPrototypeOf(WorkingArea).call(this));_this.onButton=function(){_this.flag=true;_this.initDraw(_this.divCanvas,_this.flag,_this.outputdiv);};_this.offButton=function(){_this.flag=false;_this.initDraw(_this.divCanvas,_this.flag,_this.outputdiv);};_this.initDraw=function(drawElement,flag,outputdiv){function setMousePosition(e){var ev=e||window.event;//Moz || IE\nif(ev.pageX){//Moz\nmouse.x=ev.pageX;mouse.y=ev.pageY;}else if(ev.clientX){//IE\nmouse.x=ev.clientX;mouse.y=ev.clientY;}};var mouse={x:0,y:0,startX:0,startY:0};var element=null;drawElement.onmousemove=function(e){// draw only when flad is On\nif(flag){setMousePosition(e);if(element!==null){element.style.width=Math.abs(mouse.x-mouse.startX)+'px';element.style.height=Math.abs(mouse.y-mouse.startY)+'px';element.style.left=mouse.x-mouse.startX<0?mouse.x+'px':mouse.startX+'px';element.style.top=mouse.y-mouse.startY<0?mouse.y+'px':mouse.startY+'px';}}};drawElement.onclick=function(e){console.log(\"ONorOFF : \"+flag);console.log(e);if(flag){if(element!==null){element=null;drawElement.style.cursor=\"default\";console.log(\"mouse: ENDX : \"+mouse.x);console.log(\"mouse: ENDY : \"+mouse.y);this.EndX=mouse.x;this.EndY=mouse.y-125;var dataDrawn=\"(\"+this.StartX+\",\"+this.StartY+\") (\"+this.EndX+\",\"+this.EndY+\")\";this.imageTextData=dataDrawn;outputdiv.innerHTML=outputdiv.innerHTML+\"\\n\"+dataDrawn;console.log(\"displaying here : \"+this.imageTextData);console.log(\"finsihed.\");}else{console.log(\"begun.\");mouse.startX=mouse.x;mouse.startY=mouse.y;element=document.createElement('div');element.className='rectangle';element.style.left=mouse.x+'px';element.style.top=mouse.y+'px';drawElement.appendChild(element);drawElement.style.cursor=\"crosshair\";console.log(\"mouse: STARTX : \"+mouse.x);console.log(\"mouse: startY : \"+mouse.y);this.StartX=mouse.x;this.StartY=mouse.y-125;}}};};_this.saveastextfile=function(){// send to nodejs to save\nconsole.log(\"send data to node backend : \");axios.post(\"http://192.168.1.8:4000/saveastextfile/\",{username:_this.props.name,imagename:_this.state.ImageNames[_this.state.index],imagedata:_this.outputdiv.innerHTML}).then(function(res){// then print response status\n//toast.success('upload success')\nconsole.log(\"API message : \");console.log(res);}).catch(function(err){// then print response status\n//  toast.error('upload fail')\nconsole.log(\"fail\");console.log(err);});};_this.NextImage=function(){// clearing out previously draw boxes and adding back the image tag\n_this.divCanvas.innerHTML=\"\";_this.divCanvas.appendChild(_this.ImageTag);if(_this.state.index>_this.state.ImageNames.length-2){// Do nothing\n}else{_this.state.index=_this.state.index+1;if(_this.ImageTag){_this.ImageTag.src=\"http://192.168.1.8:4000/img/\"+_this.state.ImageNames[_this.state.index];}}_this.outputdiv.innerHTML=\"\";};_this.PrevImage=function(){// clearing out previously draw boxes and adding back the image tag\n_this.divCanvas.innerHTML=\"\";_this.divCanvas.appendChild(_this.ImageTag);if(_this.state.index==0){console.log(\"start\");}else{_this.state.index=_this.state.index-1;if(_this.ImageTag){_this.ImageTag.src=\"http://192.168.1.8:4000/img/\"+_this.state.ImageNames[_this.state.index];}}_this.outputdiv.innerHTML=\"\";};_this.testSaveText=function(){var data=_this.state.ImageNames[_this.state.index]+\",\"+_this.outputdiv.innerHTML;console.log(data);axios.post(\"http://192.168.1.8:8080/saveastextfile\",data).then(function(res){// then print response status\nconsole.log(\"API : \");console.log(res);console.log(res.data[\"message\"]);}).catch(function(err){// then print response status\nconsole.log(\"FAIL\");console.log(err);});};_this.getmloutput=function(){var username=_this.props.name;var imagename=_this.state.ImageNames[_this.state.index];var url=\"http://192.168.1.8:4000/img/\"+_this.state.ImageNames[_this.state.index];var mloutputurl=\"http://192.168.1.8:4000/img/mloutput_\"+imagename;var data={'username':username,'imagename':imagename,'imageurl':url};axios.post(\"http://127.0.0.1:8000/index/\",data).then(function(res){// then print response status\n//toast.success('upload success')\nconsole.log(\"API message : \");console.log(res);window.open(mloutputurl,'_blank');}).catch(function(err){// then print response status\n//  toast.error('upload fail')\nconsole.log(\"fail\");console.log(err);});};_this.Apifuncgetimages=function(userName){// data is going to be the username\nconsole.log(\"Calling GO API at 8080 : \");axios.post(\"http://192.168.1.8:8080/getimages\",userName).then(function(res){// then print response status\nconsole.log(\"API : \");console.log(res);var ImageNames=res.data[\"data\"].split(\"</br>\");console.log(\"Image Name\");console.log(ImageNames);ImageNames.pop();console.log(ImageNames);_this.state.ImageNames=ImageNames;if(_this.ImageTag){_this.ImageTag.src=\"http://192.168.1.8:4000/img/\"+_this.state.ImageNames[_this.state.index];}}).catch(function(err){// then print response status\nconsole.log(\"FAIL\");console.log(err);});};_this.downloadfiles=function(){console.log(\"inside the downloadfiles function : \");axios.post(\"http://192.168.1.8:4000/downloadfiles/\",{username:_this.props.name}).then(function(res){// then print response status\n//toast.success('upload success')\nconsole.log(res);// after creating the file, now download\naxios({url:'http://localhost:4000/file/'+_this.props.name+'.zip',method:'GET',responseType:'blob'// important\n}).then(function(response){var url=window.URL.createObjectURL(new Blob([response.data]));var link=document.createElement('a');link.href=url;link.setAttribute('download',_this.props.name+'.zip');document.body.appendChild(link);link.click();});}).catch(function(err){// then print response status\n//  toast.error('upload fail')\nconsole.log(\"fail\");console.log(err);});};_this.state={index:0};return _this;}_createClass(WorkingArea,[{key:\"componentDidMount\",value:function componentDidMount(){// Call GO API to get all the image names of username\nthis.Apifuncgetimages(this.props.name);// setting environment variables\nthis.flag=false;this.startX=0;this.EndX=0;this.StartY=0;this.EndY=0;this.imageTextData=\" \";}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"div\",null,React.createElement(\"div\",{className:\"columnLeft\"},React.createElement(\"p\",null,\"Left Side\"),React.createElement(\"div\",{ref:function ref(c){return _this2.divCanvas=c;}},React.createElement(\"img\",{className:\"name\",ref:function ref(c){return _this2.ImageTag=c;}}))),React.createElement(\"div\",{className:\"columnRight\"},React.createElement(\"p\",null,\"Right Side\"),React.createElement(\"button\",{type:\"button\",class:\"buttonclass\",onClick:this.NextImage},\"NEXT\"),React.createElement(\"button\",{type:\"button\",class:\"buttonclass\",onClick:this.PrevImage},\"PREVIOUS\"),React.createElement(\"button\",{className:\"buttonclass\",onClick:this.onButton},\"ON\"),React.createElement(\"button\",{className:\"buttonclass\",onClick:this.offButton},\"OFF\"),React.createElement(\"button\",{className:\"buttonclass\",onClick:this.saveastextfile},\"SAVE\"),React.createElement(\"button\",{className:\"buttonclass\",onClick:this.getmloutput},\"CHECK ML OUTPUT\"),React.createElement(\"button\",{className:\"buttonclass\",onClick:this.downloadfiles},\"DOWNLOAD\")),React.createElement(\"p\",{hidden:true,ref:function ref(c){return _this2.outputdiv=c;}}));}}]);return WorkingArea;}(Component);export default WorkingArea;","map":{"version":3,"sources":["/Users/anirudhrv/Desktop/Misc/InteractiveImageAnnotation/Application/ImageAnnotation/Client/src/SPA_components/WorkingArea.js"],"names":["React","Component","axios","WorkingArea","onButton","flag","initDraw","divCanvas","outputdiv","offButton","drawElement","setMousePosition","e","ev","window","event","pageX","mouse","x","y","pageY","clientX","clientY","startX","startY","element","onmousemove","style","width","Math","abs","height","left","top","onclick","console","log","cursor","EndX","EndY","dataDrawn","StartX","StartY","imageTextData","innerHTML","document","createElement","className","appendChild","saveastextfile","post","username","props","name","imagename","state","ImageNames","index","imagedata","then","res","catch","err","NextImage","ImageTag","length","src","PrevImage","testSaveText","data","getmloutput","url","mloutputurl","open","Apifuncgetimages","userName","split","pop","downloadfiles","method","responseType","response","URL","createObjectURL","Blob","link","href","setAttribute","body","click","c"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport axios from 'axios';\n\nclass WorkingArea extends Component {\n//TODO : ADD INTRODUCTION TO PROJECT\n\nconstructor(){\n  super();\n  this.state= {\n    index:0,\n  }\n}\n\nonButton = () => {\n  this.flag = true;\n  this.initDraw(this.divCanvas,this.flag,this.outputdiv);\n\n}\noffButton = () => {\n  this.flag= false;\n  this.initDraw(this.divCanvas,this.flag,this.outputdiv );\n}\n\ninitDraw= (drawElement,flag,outputdiv) => {\n    function setMousePosition(e) {\n        var ev = e || window.event; //Moz || IE\n        if (ev.pageX) { //Moz\n            mouse.x = ev.pageX;\n            mouse.y = ev.pageY;\n        }\n        else if (ev.clientX) { //IE\n            mouse.x = ev.clientX ;\n            mouse.y = ev.clientY ;\n        }\n    };\n\n    var mouse = {\n        x: 0,\n        y: 0,\n        startX: 0,\n        startY: 0\n    };\n    var element = null;\n\n    drawElement.onmousemove = function (e) {\n      // draw only when flad is On\n      if(flag) {\n        setMousePosition(e);\n        if (element !== null) {\n            element.style.width = Math.abs(mouse.x - mouse.startX) + 'px';\n            element.style.height = Math.abs(mouse.y - mouse.startY) + 'px';\n            element.style.left = (mouse.x - mouse.startX < 0) ? mouse.x + 'px' : mouse.startX + 'px';\n            element.style.top = (mouse.y - mouse.startY < 0) ? mouse.y + 'px' : mouse.startY + 'px';\n        }\n      }\n    }\n\n    drawElement.onclick = function (e) {\n      console.log(\"ONorOFF : \"+flag);\n      console.log(e);\n      if(flag) {\n        if (element !== null) {\n            element = null;\n            drawElement.style.cursor = \"default\";\n            console.log(\"mouse: ENDX : \"+mouse.x)\n            console.log(\"mouse: ENDY : \"+mouse.y)\n            this.EndX = mouse.x;\n            this.EndY = mouse.y - 125;\n            var dataDrawn = \"(\"+this.StartX+\",\"+this.StartY+\") (\"+this.EndX+\",\"+this.EndY+\")\"\n            this.imageTextData = dataDrawn\n            outputdiv.innerHTML = outputdiv.innerHTML +\"\\n\"+dataDrawn\n            console.log(\"displaying here : \"+this.imageTextData)\n            console.log(\"finsihed.\");\n\n        }\n        else {\n            console.log(\"begun.\");\n            mouse.startX = mouse.x;\n            mouse.startY = mouse.y;\n            element = document.createElement('div');\n            element.className = 'rectangle'\n            element.style.left = mouse.x + 'px';\n            element.style.top = mouse.y + 'px';\n            drawElement.appendChild(element)\n            drawElement.style.cursor = \"crosshair\";\n            console.log(\"mouse: STARTX : \"+mouse.x)\n            console.log(\"mouse: startY : \"+mouse.y)\n            this.StartX = mouse.x;\n            this.StartY = mouse.y - 125;\n        }\n    }\n  }\n}\n\nsaveastextfile = () =>{\n  // send to nodejs to save\n  console.log(\"send data to node backend : \")\n  axios.post(\"http://192.168.1.8:4000/saveastextfile/\",{\n    username : this.props.name,\n    imagename : this.state.ImageNames[this.state.index],\n    imagedata : this.outputdiv.innerHTML\n    })\n    .then(res => { // then print response status\n      //toast.success('upload success')\n      console.log(\"API message : \")\n      console.log(res)\n    })\n    .catch(err => { // then print response status\n    //  toast.error('upload fail')\n    console.log(\"fail\")\n    console.log(err)\n    })\n}\nNextImage= () => {\n  // clearing out previously draw boxes and adding back the image tag\n  this.divCanvas.innerHTML = \"\";\n  this.divCanvas.appendChild(this.ImageTag);\n\n  if(this.state.index>this.state.ImageNames.length-2) {\n    // Do nothing\n  }\n  else {\n    this.state.index = this.state.index + 1\n    if(this.ImageTag) {\n     this.ImageTag.src = \"http://192.168.1.8:4000/img/\"+this.state.ImageNames[this.state.index];\n      }\n    }\n  this.outputdiv.innerHTML = \"\";\n}\n\n\nPrevImage= () => {\n  // clearing out previously draw boxes and adding back the image tag\n  this.divCanvas.innerHTML = \"\";\n  this.divCanvas.appendChild(this.ImageTag);\n  if(this.state.index == 0) {\n    console.log(\"start\")\n  }\n  else {\n  this.state.index = this.state.index - 1\n  if(this.ImageTag) {\n   this.ImageTag.src = \"http://192.168.1.8:4000/img/\"+this.state.ImageNames[this.state.index];\n    }\n  }\n  this.outputdiv.innerHTML = \"\";\n}\n\ntestSaveText = () =>{\n  var data = this.state.ImageNames[this.state.index]+\",\"+ this.outputdiv.innerHTML\n  console.log(data)\n  axios.post(\"http://192.168.1.8:8080/saveastextfile\",data)\n    .then(res => { // then print response status\n      console.log(\"API : \")\n      console.log(res)\n      console.log(res.data[\"message\"])\n    })\n    .catch(err => { // then print response status\n    console.log(\"FAIL\")\n    console.log(err)\n    })\n\n}\n\ngetmloutput = () =>{\n  var username = this.props.name\n  var imagename = this.state.ImageNames[this.state.index]\n  var url = \"http://192.168.1.8:4000/img/\"+this.state.ImageNames[this.state.index]\n  var mloutputurl = \"http://192.168.1.8:4000/img/mloutput_\"+imagename\n  var data = {'username':username,'imagename':imagename,'imageurl':url}\n  axios.post(\"http://127.0.0.1:8000/index/\",data)\n    .then(res => { // then print response status\n      //toast.success('upload success')\n      console.log(\"API message : \")\n      console.log(res)\n      window.open(mloutputurl, '_blank');\n    })\n    .catch(err => { // then print response status\n    //  toast.error('upload fail')\n    console.log(\"fail\")\n    console.log(err)\n    })\n}\nApifuncgetimages = (userName) => {\n  // data is going to be the username\n  console.log(\"Calling GO API at 8080 : \")\n  axios.post(\"http://192.168.1.8:8080/getimages\",userName)\n    .then(res => { // then print response status\n      console.log(\"API : \")\n      console.log(res)\n       var ImageNames = res.data[\"data\"].split(\"</br>\");\n       console.log(\"Image Name\")\n       console.log(ImageNames)\n       ImageNames.pop();\n       console.log(ImageNames)\n       this.state.ImageNames = ImageNames\n         if(this.ImageTag) {\n          this.ImageTag.src = \"http://192.168.1.8:4000/img/\"+this.state.ImageNames[this.state.index];\n       }\n    })\n    .catch(err => { // then print response status\n    console.log(\"FAIL\")\n    console.log(err)\n    })\n  }\n\ndownloadfiles = () =>{\n    console.log(\"inside the downloadfiles function : \")\n    axios.post(\"http://192.168.1.8:4000/downloadfiles/\",{\n      username : this.props.name\n    })\n      .then(res => { // then print response status\n        //toast.success('upload success')\n        console.log(res)\n        // after creating the file, now download\n        axios({\n          url: 'http://localhost:4000/file/'+this.props.name+'.zip',\n          method: 'GET',\n          responseType: 'blob', // important\n        }).then((response) => {\n          const url = window.URL.createObjectURL(new Blob([response.data]));\n          const link = document.createElement('a');\n          link.href = url;\n          link.setAttribute('download', this.props.name+'.zip');\n          document.body.appendChild(link);\n          link.click();\n        });\n      })\n      .catch(err => {\n      // then print response status\n      //  toast.error('upload fail')\n      console.log(\"fail\")\n      console.log(err)\n      })\n}\n\ncomponentDidMount(){\n    // Call GO API to get all the image names of username\n    this.Apifuncgetimages(this.props.name)\n\n    // setting environment variables\n    this.flag = false;\n    this.startX = 0;\n    this.EndX = 0;\n    this.StartY = 0;\n    this.EndY = 0;\n    this.imageTextData = \" \";\n}\n\nrender() {\n    return (\n      <div>\n        <div className = \"columnLeft\">\n        <p>Left Side</p>\n          <div ref = {c => this.divCanvas = c} >\n          <img className='name' ref = {c => this.ImageTag = c}/>\n          </div>\n        </div>\n        <div className = \"columnRight\">\n        <p>Right Side</p>\n          <button type=\"button\" class=\"buttonclass\" onClick={this.NextImage}>NEXT</button>\n          <button type=\"button\" class=\"buttonclass\" onClick={this.PrevImage}>PREVIOUS</button>\n          <button className=\"buttonclass\" onClick={this.onButton}>ON</button>\n          <button className=\"buttonclass\" onClick={this.offButton}>OFF</button>\n          <button className=\"buttonclass\" onClick={this.saveastextfile}>SAVE</button>\n          <button className=\"buttonclass\" onClick={this.getmloutput}>CHECK ML OUTPUT</button>\n          <button className=\"buttonclass\" onClick={this.downloadfiles}>DOWNLOAD</button>\n\n        </div>\n        <p hidden ref = {c =>this.outputdiv = c}>\n        </p>\n      </div>\n    );\n  }\n}\nexport default WorkingArea;\n"]},"metadata":{},"sourceType":"module"}